# 3.3 注释规范

## 3.3.1 文件注释
1. 文件头部注释
   ```python
   """
   遥感影像智能解译系统
   
   本模块提供遥感影像数据的预处理、分类和分割功能。
   
   Author: 作者名
   Date: 2024-01-01
   Version: 1.0.0
   """
   ```

2. 模块说明
   ```python
   """
   图像处理模块
   
   提供图像读取、预处理、增强等功能。
   
   Dependencies:
       - numpy
       - opencv-python
       - scikit-image
   """
   ```

## 3.3.2 类注释
1. 类定义注释
   ```python
   class ImageProcessor:
       """图像处理器
       
       用于处理遥感图像数据的核心类，提供图像读取、预处理、增强等功能。
       
       Attributes:
           config (dict): 配置参数，包含图像处理的相关设置
           model (object): 处理模型，用于图像分类或分割
           
       Example:
           >>> processor = ImageProcessor(config)
           >>> result = processor.process(image)
       """
   ```

2. 类方法注释
   ```python
   def process_image(self, image: np.ndarray) -> np.ndarray:
       """处理输入图像
       
       对输入的遥感图像进行预处理、增强等操作。
       
       Args:
           image (np.ndarray): 输入图像，格式为(H, W, C)的numpy数组
           
       Returns:
           np.ndarray: 处理后的图像，格式与输入相同
           
       Raises:
           ValueError: 当输入图像格式不正确时
           
       Example:
           >>> image = np.random.rand(100, 100, 3)
           >>> processed = processor.process_image(image)
       """
   ```

## 3.3.3 函数注释
1. 函数定义注释
   ```python
   def load_dataset(path: str, format: str = 'tif') -> List[np.ndarray]:
       """加载数据集
       
       从指定路径加载遥感图像数据集。
       
       Args:
           path (str): 数据集路径
           format (str, optional): 图像格式. Defaults to 'tif'.
           
       Returns:
           List[np.ndarray]: 图像列表
           
       Raises:
           FileNotFoundError: 当数据集路径不存在时
           ValueError: 当图像格式不支持时
       """
   ```

2. 参数说明
   ```python
   def train_model(
       model: nn.Module,
       train_data: DataLoader,
       val_data: DataLoader,
       epochs: int = 100,
       learning_rate: float = 0.001
   ) -> Dict[str, float]:
       """训练模型
       
       Args:
           model: 待训练的模型
           train_data: 训练数据加载器
           val_data: 验证数据加载器
           epochs: 训练轮数
           learning_rate: 学习率
           
       Returns:
           包含训练结果的字典
       """
   ```

## 3.3.4 代码注释
1. 行内注释
   ```python
   # 图像预处理
   image = cv2.resize(image, (1024, 1024))  # 调整图像大小
   image = image / 255.0  # 归一化到[0,1]
   
   # 数据增强
   if self.augment:
       image = self._random_flip(image)  # 随机翻转
       image = self._random_rotate(image)  # 随机旋转
   ```

2. 块注释
   ```python
   # 图像预处理流程
   # 1. 读取图像
   # 2. 调整大小
   # 3. 数据增强
   # 4. 标准化
   image = self._read_image(path)
   image = self._resize(image)
   image = self._augment(image)
   image = self._normalize(image)
   ```

## 3.3.5 异常注释
1. 异常类注释
   ```python
   class ImageFormatError(Exception):
       """图像格式错误
       
       当输入图像格式不符合要求时抛出此异常。
       
       Attributes:
           message (str): 错误信息
           format (str): 不支持的格式
       """
   ```

2. 异常处理注释
   ```python
   try:
       # 尝试加载图像
       image = self._load_image(path)
   except FileNotFoundError:
       # 文件不存在时记录日志并抛出异常
       logger.error(f"找不到图像文件: {path}")
       raise
   except ValueError as e:
       # 图像格式错误时记录日志并抛出异常
       logger.error(f"图像格式错误: {str(e)}")
       raise ImageFormatError(str(e))
   ```

## 3.3.6 配置注释
1. 配置文件注释
   ```yaml
   # 图像处理配置
   image_processing:
     # 最大图像尺寸
     max_size: 1024
     # 批处理大小
     batch_size: 32
     # 支持的图像格式
     supported_formats:
       - tif
       - jpg
       - png
   
   # 模型训练配置
   model_training:
     # 学习率
     learning_rate: 0.001
     # 训练轮数
     epochs: 100
     # 早停轮数
     early_stopping: 10
   ```

2. 环境变量注释
   ```bash
   # 数据集路径
   DATASET_PATH=/path/to/dataset
   
   # 模型保存路径
   MODEL_SAVE_DIR=/path/to/models
   
   # 日志级别
   LOG_LEVEL=INFO
   ```

## 3.3.7 文档注释
1. 模块文档
   ```python
   """
   遥感影像处理模块
   
   本模块提供遥感影像数据的处理功能，包括：
   1. 图像读取和保存
   2. 图像预处理
   3. 数据增强
   4. 图像分类
   5. 语义分割
   
   Usage:
       >>> from remote_sensing import ImageProcessor
       >>> processor = ImageProcessor()
       >>> result = processor.process(image)
   """
   ```

2. 示例文档
   ```python
   """
   使用示例
   
   1. 加载图像
      >>> image = load_image('path/to/image.tif')
   
   2. 预处理
      >>> processed = preprocess(image)
   
   3. 分类
      >>> result = classify(processed)
   
   4. 保存结果
      >>> save_result(result, 'path/to/result.tif')
   """
   ``` 