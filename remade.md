# 系统架构与文件组织

本系统采用分层的设计模式，并且严格遵循了**模型-视图-控制器 (MVC)** 或类似的架构模式。其主要组成部分及其对应的文件组织结构如下：

## 1. 视图层 (View) - `ui/` 目录

*   **职责**: 负责用户界面的展示和用户交互的接收。
*   **实现**: 使用 `PySide6` GUI 框架构建。
*   **核心文件**:
    *   `ui/main_window_new.py`: 定义主窗口 `MainWindow` 类，作为应用程序的整体框架。
    *   `ui/` 目录下可能包含多个 `*_page.py` 文件（如 `fishnet_page.py`, `scene_page.py` 等），每个文件定义一个独立的功能页面，这些页面被嵌入到 `MainWindow` 中。

## 2. 控制器层 (Controller) - `controller/` 目录

*   **职责**: 处理用户界面的事件（如按钮点击），调用模型层执行业务逻辑，并更新视图层展示结果。作为视图层和模型层之间的桥梁。
*   **实现**: 代码位于 `controller/event/` 包下。
*   **核心文件**:
    *   为每一项核心功能（如渔网生成、场景分类、目标检测、变化检测、批量处理等）都配备了一个独立的控制器类（如 `FishnetController`, `SceneController`, `ObjectDetectionController`, `ChangeDetectionController`, `BatchController` 等），通常命名为 `*_controller.py`。
    *   每个控制器通过 `setup` 方法与对应的视图页面关联，并通过 `connect_signals` 方法连接信号与槽，响应用户操作。

## 3. 模型层 (Model) - `Function/` 等目录 (推测)

*   **职责**: 包含应用程序的核心业务逻辑、数据处理算法和与外部服务（如模型推理引擎）的交互。
*   **实现**: `main.py` 和控制器代码并未直接明确展示模型层的具体实现，但根据功能推测：
    *   **`Function/` 目录**: 很可能包含了核心的算法实现，例如图像处理、模型推理、数据转换等功能的具体代码。
    *   **`utils/` 目录**: 可能包含一些通用的工具函数或类，被视图、控制器或模型层复用。
*   **交互**: 控制器层调用模型层提供的接口来完成具体任务（例如，`ChangeDetectionController` 可能调用 `Function/` 目录下的变化检测算法函数）。

## 4. 启动与组装 - `main.py`

*   **职责**: 作为整个应用程序的入口点，负责初始化环境、创建视图和控制器实例，并将它们组装、连接起来，最后启动应用程序。
*   **流程**:
    1.  初始化 `QApplication` 和设置必要的环境变量（如 Qt 插件路径）。
    2.  创建主窗口 `MainWindow` 实例。
    3.  创建所有控制器实例（`FishnetController`, `SceneController` 等）。
    4.  调用控制器的 `setup` 方法，将对应的视图页面传递给控制器。
    5.  调用视图页面的 `connect_signals` 方法，将用户界面信号连接到控制器的槽函数。
    6.  显示主窗口。
    7.  启动 Qt 事件循环 (`app.exec()`)。

## 总结

该系统架构清晰地划分了用户界面 (`ui/`)、业务逻辑控制 (`controller/`) 和核心功能实现 (`Function/`, `utils/` 等) 各层的职责。`main.py` 作为启动脚本，有效地将这些分散的模块组织在一起，形成一个可运行的应用程序。这种分层和模块化的结构有利于代码的维护、扩展和团队协作。